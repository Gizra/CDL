"use strict";!function(){function a(a){var b;return a.active||a.selected?a.active&&!a.selected?b=1:!a.active&&a.selected?b=2:a.active&&a.selected&&(b=3):b=0,b}function b(){h=o.select("body").append("svg").attr("width",s).attr("height",t).call(o.behavior.zoom().scaleExtent([1,10]).on("zoom",e)),k=h.append("rect").attr("class","background").attr("width",s).attr("height",t),i=h.append("g").attr("class","tree"),r=!1,r&&(j=h.append("svg:circle").attr("class","center").attr("r",3).attr("cx",function(){return s/2}).attr("cy",function(){return t/2}))}function c(){var a=p.defer(),b=window.location.href+"data/tree.json";return o.json(b,function(b,c){return b?console.warn(b):(a.resolve(c),void 0)}),a.promise}function d(a){a.x0=s/2,a.y0=0,l=o.layout.tree().size([s,t]),m=l.nodes(a),n=l.links(m),m.forEach(function(a){a.y=0===a.depth?40:v(a.depth),a.active=0,a.selected=0});var b=i.append("svg:g").attr("class","lines"),c=b.selectAll("g.link").data(n).enter();c.append("svg:line").style("stroke","black").style("stroke-width",2).attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y});var d=i.selectAll("g.node").data(m).enter().append("svg:g").attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).attr("class","node").attr("id",function(a,b){return"n"+b});d.append("svg:circle").attr("r",function(a){return w(a.selected)}).style("fill",function(a){return x(a.active)}).on("click",f),d.append("svg:text").attr("font-size",function(a){return y(a.selected)}).attr("dy",function(a){return a.children?1:10}).attr("dx",function(a){return a.children?7:a}).attr("text-anchor",function(a){return a.selected?"middle":a.children?"start":"middle"}).text(function(a){return a.name})}function e(){i.attr("transform","translate("+o.event.translate+")scale("+o.event.scale+")")}function f(a,b){function c(a){var b;b=q.where(m,{active:1}),b.length&&b.forEach(function(a){a.active=0,a.selected=0}),0!==a.depth&&(j=a.parent.children,q.min(j,function(a){return a.x}).connection="end",q.max(j,function(a){return a.x}).connection="start",j.forEach(function(a){a.active=1,a.selected=0,k.push({x:a.x,y:a.y})})),a.active=1,a.selected=1}function d(){i.select(".lines").select("path").data([]).exit().remove();var a=o.svg.line().x(function(a){return a.x}).y(function(a){return a.y}).interpolate("linear");console.log(A(0)),i.select(".lines").selectAll("path"+b).data([k]).enter().append("path").style("fill","white").style("stroke","white").style("stroke-width",2).transition().duration(u).style("fill","red").style("stroke","red").style("stroke-width",2).attr("id","p"+b).attr("d",a)}function e(){f=s/2-a.x,h=t/2-a.y,i.transition().duration(u).attr("transform",null)}var f,h,j=[],k=[];c(a),g(),d(),e()}function g(){o.select("g.tree").selectAll("circle").transition().duration(u).attr("r",function(a){return w(a.selected)}).style("fill",function(a){return x(a.active)}),o.select("g.tree").selectAll("text").transition().duration(u/7).attr("font-size",function(a){return y(a.selected)}).style("fill",function(b){return z(a(b))}).attr("dy",function(a){return a.selected?0:a.children?1:10}).attr("dx",function(a){return a.selected?0:a.children?7:a}).attr("text-anchor",function(a){return a.selected?"middle":a.children?"start":"middle"})}var h,i,j,k,l,m,n,o=window.d3,p=window.Q,q=window._,r=!1,s=1e3,t=800,u=750,v=o.scale.linear().domain([0,7]).range([0,s]),w=o.scale.linear().domain([0,1]).range([5,20]),x=o.scale.linear().domain([0,1]).range(["black","red"]),y=o.scale.linear().domain([0,1]).range([2.5,5]),z=o.scale.linear().domain([0,1,3]).range(["black","red","white"]),A=o.scale.linear().domain([0,1]).range(["white","red"]);b(),c().then(function(a){d(a)})}();