"use strict";!function(){function a(a){var b;return a.active||a.selected?a.active&&!a.selected?b=1:!a.active&&a.selected?b=2:a.active&&a.selected&&(b=3):b=0,b}function b(){var a;a=q.behavior.zoom().center([u/2,v/2]).scaleExtent([1,10]).on("zoom",g),j=q.select("body").append("svg").attr("width",u).attr("height",v).call(a),m=j.append("rect").attr("class","background").attr("width",u).attr("height",v),k=j.append("g").attr("class","tree"),t=!1,t&&(l=j.append("svg:circle").attr("class","center").attr("r",3).attr("cx",function(){return u/2}).attr("cy",function(){return v/2}))}function c(){var a=r.defer(),b=window.location.href+"data/tree.json";return q.json(b,function(b,c){return b?console.warn(b):(a.resolve(c),void 0)}),a.promise}function d(a){a.x0=u/2,a.y0=v/4,n=q.layout.tree().size([u,v]),o=n.nodes(a),p=n.links(o),o.forEach(function(b){b.y=0===b.depth?1+a.y0:x(b.depth)+a.y0,b.active=0,b.selected=0});var b=k.append("svg:g").attr("class","lines"),c=b.selectAll("g.link").data(p).enter();c.append("svg:line").style("stroke","black").style("stroke-width",2).attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y});var d=k.selectAll("g.node").data(o).enter().append("svg:g").attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).attr("class","node").attr("id",function(a,b){return"n"+b});d.append("svg:circle").attr("r",function(a){return y(a.selected)}).style("fill",f).style("stroke",function(a){return a.active?"red":"black"}).on("click",h),d.append("svg:text").attr("class","name").attr("font-size",function(a){return A(a.selected)}).attr("dy",function(a){return a.children?1:10}).attr("dx",function(a){return a.children?7:a}).attr("text-anchor",function(a){return a.selected?"middle":a.children?"start":"middle"}).text(e),d.append("svg:text").attr("class","id").attr("font-size",5).attr("dy",2).attr("dx",0).attr("text-anchor","middle").text(function(a){return a.chronologicalId}).on("click",h)}function e(a){return"chronological"===a.type?a.chronologicalName:a.name}function f(a){return"chronological"!==a.type||a.active?z(a.active):"white"}function g(){k.attr("transform","translate("+q.event.translate+")scale("+q.event.scale+")")}function h(a,b){function c(a){var b;b=s.where(o,{active:1}),b.length&&b.forEach(function(a){a.active=0,a.selected=0}),0!==a.depth&&(e=a.parent.children,s.min(e,function(a){return a.x}).connection="end",s.max(e,function(a){return a.x}).connection="start",e.forEach(function(a){a.active=1,a.selected=0,f.push({x:a.x,y:a.y})})),a.active=1,a.selected=1}function d(){k.select(".lines").select("path").data([]).exit().remove();var a=q.svg.line().x(function(a){return a.x}).y(function(a){return a.y}).interpolate("linear");k.select(".lines").selectAll("path"+b).data([f]).enter().append("path").style("fill","white").style("stroke","white").style("stroke-width",2).transition().duration(w).style("fill","red").style("stroke","red").style("stroke-width",2).attr("id","p"+b).attr("d",a)}var e=[],f=[];c(a),i(),d()}function i(){q.select("g.tree").selectAll("circle").transition().duration(w).attr("r",function(a){return y(a.selected)}).style("fill",f).style("stroke",function(a){return a.active?"red":"black"}),q.select("g.tree").selectAll("text.name").transition().duration(w/7).attr("font-size",function(a){return A(a.selected)}).style("fill",function(b){return B(a(b))}).attr("dy",function(a){return a.selected?0:a.children?1:10}).attr("dx",function(a){return a.selected?0:a.children?7:a}).attr("text-anchor",function(a){return a.selected?"middle":a.children?"start":"middle"}),q.select("g.tree").selectAll("text.id").transition().duration(w/7).text(function(a){return a.active?"":a.chronologicalId})}var j,k,l,m,n,o,p,q=window.d3,r=window.Q,s=window._,t=!1,u=960,v=800,w=750,x=q.scale.linear().domain([0,30]).range([0,u]),y=q.scale.linear().domain([0,1]).range([5,20]),z=q.scale.linear().domain([0,1]).range(["black","red"]),A=q.scale.linear().domain([0,1]).range([2.5,5]),B=q.scale.linear().domain([0,1,3]).range(["black","red","white"]);b(),c().then(function(a){d(a)})}();